<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Buildings.Fluid.Interfaces</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="&quot;Package with interfaces for fluid models&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 9pt; font-family: Courier, monospace; white-space: pre; }
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { border: 1px solid #808080; vertical-align: top; }
th      { border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- --- header ------ -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- --- end header -- -->

<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Interfaces<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Interfaces"></a><a href="Buildings_Fluid.html#Buildings.Fluid"
>Buildings.Fluid</a>.Interfaces</h2>
<p>
<b>Package with interfaces for fluid models</b><br>
</p>
<h3>Information</h3>

<p>
This package contains basic classes that are used to build
component models that change the state of the
fluid. The classes are not directly usable, but can
be extended when building a new model.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons_InterfacesPackage.html#Modelica.Icons.InterfacesPackage"
>Modelica.Icons.InterfacesPackage</a> (Icon for packages containing interfaces).</p>
<h3>Package Content</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Package Content">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfaces.UsersGuideS.png" alt="Buildings.Fluid.Interfaces.UsersGuide" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces_UsersGuide.html#Buildings.Fluid.Interfaces.UsersGuide"
>UsersGuide</a>
</td>
<td>User&#39;s Guide</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interface1d8308de49633a59ationS.png" alt="Buildings.Fluid.Interfaces.ConservationEquation" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.ConservationEquation"
>ConservationEquation</a>
</td>
<td>Lumped volume with mass and energy balance</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfaces.FourPortS.png" alt="Buildings.Fluid.Interfaces.FourPort" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPort"
>FourPort</a>
</td>
<td>Partial model with four ports</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacebc5fa511548cb52detersS.png" alt="Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"
>FourPortFlowResistanceParameters</a>
</td>
<td>Parameters for flow resistance for models with four ports</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interface997284f3a7348477angerS.png" alt="Buildings.Fluid.Interfaces.FourPortHeatMassExchanger" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortHeatMassExchanger"
>FourPortHeatMassExchanger</a>
</td>
<td>Model transporting two fluid streams between four ports with storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacec1e50ba794a32b14tionsS.png" alt="Buildings.Fluid.Interfaces.LumpedVolumeDeclarations" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>LumpedVolumeDeclarations</a>
</td>
<td>Declarations for lumped volumes</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interface0bf626e24a9671a0rfaceS.png" alt="Buildings.Fluid.Interfaces.PartialFourPortInterface" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>PartialFourPortInterface</a>
</td>
<td>Partial model transporting fluid between two ports without storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacece5744ecb2dac5c0rfaceS.png" alt="Buildings.Fluid.Interfaces.PartialTwoPortInterface" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>PartialTwoPortInterface</a>
</td>
<td>Partial model transporting fluid between two ports without storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacecfb0ac59541ba4f9angerS.png" alt="Buildings.Fluid.Interfaces.StaticFourPortHeatMassExchanger" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticFourPortHeatMassExchanger"
>StaticFourPortHeatMassExchanger</a>
</td>
<td>Partial model transporting two fluid streams between four ports without storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacea868bbaf7da4f56dationS.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation"
>StaticTwoPortConservationEquation</a>
</td>
<td>Partial model for static energy and mass conservation equations</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacee19327459e14118bangerS.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"
>StaticTwoPortHeatMassExchanger</a>
</td>
<td>Partial model transporting fluid between two ports without storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacebe67f7212143d554etersS.png" alt="Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>TwoPortFlowResistanceParameters</a>
</td>
<td>Parameters for flow resistance for models with two ports</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfaceaa717523098d688cangerS.png" alt="Buildings.Fluid.Interfaces.TwoPortHeatMassExchanger" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortHeatMassExchanger"
>TwoPortHeatMassExchanger</a>
</td>
<td>Partial model transporting one fluid stream with storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfaces.ExamplesS.png" alt="Buildings.Fluid.Interfaces.Examples" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces_Examples.html#Buildings.Fluid.Interfaces.Examples"
>Examples</a>
</td>
<td>Collection of models that illustrate model use and test models</td>
</tr>
</table>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ConservationEquation<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interface1d8308de49633a59ationI.png" alt="Buildings.Fluid.Interfaces.ConservationEquation" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.ConservationEquation"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.ConservationEquation</h2>
<p>
<b>Lumped volume with mass and energy balance</b>
<br>
<br><img src="Buildings.Fluid.Interface1d8308de49633a59ationD.png" alt="Buildings.Fluid.Interfaces.ConservationEquation">
</p>
<h3>Information</h3>

<p>
Basic model for an ideally mixed fluid volume with the ability to store mass and energy.
It implements a dynamic or a steady-state conservation equation for energy and mass fractions.
The model has zero pressure drop between its ports.
</p>
<h4>Implementation</h4>
<p>
When extending or instantiating this model, the input 
<code>fluidVolume</code>, which is the actual volume occupied by the fluid,
needs to be assigned.
For most components, this can be set to a parameter.
</p>
Input connectors of the model are
<ul>
<li>
<code>Q_flow</code>, which is the sensible plus latent heat flow rate added to the medium, and
</li>
<li>
<code>mWat_flow</code>, which is the moisture mass flow rate added to the medium.
</li>
</ul>
<p>
The model can be used as a dynamic model or as a steady-state model.
However, for a steady-state model with exactly two fluid ports connected, 
the model
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation"
>
Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation</a>
provides a more efficient implementation.
</p>
<p>
For a model that instantiates this model, see
<a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>
Buildings.Fluid.MixingVolumes.MixingVolume</a>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</a> (Declarations for lumped volumes).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_nominal[Medium.nC]</td><td>fill(1E-2, Medium.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>VesselFluidPorts_b</a></td><td>ports[nPorts]</td><td>Fluid inlets and outlets</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>Q_flow</td><td>Sensible plus latent heat flow rate transfered into the medium [W]</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>mWat_flow</td><td>Moisture mass flow rate added to the medium [kg/s]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>hOut</td><td>Leaving enthalpy of the component [J/kg]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>XiOut[Medium.nXi]</td><td>Leaving species concentration of the component [1]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>COut[Medium.nC]</td><td>Leaving trace substances of the component</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">model</span> ConservationEquation <span style="color: #006400">
  &quot;Lumped volume with mass and energy balance&quot;</span>

<span style="color: #006400">//  outer Modelica.Fluid.System system &quot;System properties&quot;;</span>
  <span style="color: blue">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</a>;
  <span style="color: #006400">// Port definitions</span>
  <span style="color: blue">parameter </span>Integer nPorts=0 <span style="color: #006400">&quot;Number of ports&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b</a> ports[nPorts](
      <span style="color: blue">redeclare </span><span style="color: blue">each </span><span style="color: blue">package</span> Medium = Medium) <span style="color: #006400">&quot;Fluid inlets and outlets&quot;</span>;

  <span style="color: #006400">// Set nominal attributes where literal values can be used.</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</a> medium(
    preferredMediumStates= <span style="color: blue">not </span>(energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState),
    p(start=p_start,
      nominal=Medium.p_default,
      stateSelect=<span style="color: blue">if </span><span style="color: blue">not </span>(massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue">
                     then </span>StateSelect.prefer<span style="color: blue"> else </span>StateSelect.default),
    h(start=hStart),
    T(start=T_start,
      nominal=Medium.T_default,
      stateSelect=<span style="color: blue">if </span>(<span style="color: blue">not </span>(energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState))<span style="color: blue">
                     then </span>StateSelect.prefer<span style="color: blue"> else </span>StateSelect.default),
    Xi(start=X_start[1:Medium.nXi],
       nominal=Medium.X_default[1:Medium.nXi],
       <span style="color: blue">each </span>stateSelect=<span style="color: blue">if </span>(<span style="color: blue">not </span>(substanceDynamics == Modelica.Fluid.Types.Dynamics.SteadyState))<span style="color: blue">
                     then </span>StateSelect.prefer<span style="color: blue"> else </span>StateSelect.default),
    d(start=rho_nominal)) <span style="color: #006400">&quot;Medium properties&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Modelica.SIunits.Energy</a> U <span style="color: #006400">&quot;Internal energy of fluid&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</a> m <span style="color: #006400">&quot;Mass of fluid&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</a>[Medium.nXi] mXi <span style="color: #006400">
    &quot;Masses of independent components in the fluid&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</a>[Medium.nC] mC <span style="color: #006400">&quot;Masses of trace substances in the fluid&quot;</span>;
  <span style="color: #006400">// C need to be added here because unlike for Xi, which has medium.Xi,</span>
  <span style="color: #006400">// there is no variable medium.C</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium.ExtraProperty</a> C[Medium.nC](nominal=C_nominal) <span style="color: #006400">
    &quot;Trace substance mixture content&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> mb_flow <span style="color: #006400">&quot;Mass flows across boundaries&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a>[Medium.nXi] mbXi_flow <span style="color: #006400">
    &quot;Substance mass flows across boundaries&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraPropertyFlowRate"
>Medium.ExtraPropertyFlowRate</a>[Medium.nC] mbC_flow <span style="color: #006400">
    &quot;Trace substance mass flows across boundaries&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.EnthalpyFlowRate"
>Modelica.SIunits.EnthalpyFlowRate</a> Hb_flow <span style="color: #006400">
    &quot;Enthalpy flow across boundaries or energy source/sink&quot;</span>;

  <span style="color: #006400">// Inputs that need to be defined by an extending class</span>
  <span style="color: blue">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Modelica.SIunits.Volume</a> fluidVolume <span style="color: #006400">&quot;Volume&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> Q_flow(unit=&quot;W&quot;) <span style="color: #006400">
    &quot;Sensible plus latent heat flow rate transfered into the medium&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> mWat_flow(unit=&quot;kg/s&quot;) <span style="color: #006400">
    &quot;Moisture mass flow rate added to the medium&quot;</span>;

  <span style="color: #006400">// Outputs that are needed in models that extend this model</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> hOut(unit=&quot;J/kg&quot;,
                                             start=hStart) <span style="color: #006400">
    &quot;Leaving enthalpy of the component&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> XiOut[Medium.nXi](<span style="color: blue">each </span>unit=&quot;1&quot;,
                                                          <span style="color: blue">each </span>min=0,
                                                          <span style="color: blue">each </span>max=1) <span style="color: #006400">
    &quot;Leaving species concentration of the component&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> COut[Medium.nC](<span style="color: blue">each </span>min=0) <span style="color: #006400">
    &quot;Leaving trace substances of the component&quot;</span>;
<span style="color: blue">protected </span>
  <span style="color: blue">parameter </span>Boolean initialize_p = <span style="color: blue">not </span>Medium.singleState <span style="color: #006400">
    &quot;= true to set up initial equations for pressure&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.EnthalpyFlowRate"
>Medium.EnthalpyFlowRate</a> ports_H_flow[nPorts];
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> ports_mXi_flow[nPorts,Medium.nXi];
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraPropertyFlowRate"
>Medium.ExtraPropertyFlowRate</a> ports_mC_flow[nPorts,Medium.nC];

  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho_nominal=<span style="color: red">Medium.density</span>(
   <span style="color: red">Medium.setState_pTX</span>(
     T=T_start,
     p=p_start,
     X=X_start[1:Medium.nXi])) <span style="color: #006400">&quot;Density, used to compute fluid mass&quot;</span>;

  <span style="color: #006400">// Parameter that is used to construct the vector mXi_flow</span>
  <span style="color: blue">final </span><span style="color: blue">parameter </span>Real s[Medium.nXi] = {<span style="color: blue">if </span><span style="color: red">Modelica.Utilities.Strings.isEqual</span>(string1=Medium.substanceNames[i],
                                            string2=&quot;Water&quot;,
                                            caseSensitive=false)<span style="color: blue">
                                            then </span>1<span style="color: blue"> else </span>0 <span style="color: blue">for </span>i<span style="color: blue"> in </span>1:Medium.nXi} <span style="color: #006400">
    &quot;Vector with zero everywhere except where species is&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> hStart=
    <span style="color: red">Medium.specificEnthalpy_pTX</span>(p_start, T_start, X_start) <span style="color: #006400">
    &quot;Start value for specific enthalpy&quot;</span>;
<span style="color: blue">initial </span><span style="color: blue">equation </span>
  <span style="color: #006400">// Assert that the substance with name &#39;water&#39; has been found.</span>
  <span style="color: red">assert</span>(Medium.nXi == 0<span style="color: blue"> or </span><span style="color: red">abs</span>(<span style="color: red">sum</span>(s)-1) &lt; 1e-5,
      &quot;If Medium.nXi &gt; 1, then substance &#39;water&#39; must be present for one component.&#39;&quot;
         + Medium.mediumName + &quot;&#39;.\n&quot;
         + &quot;Check medium model.&quot;);

  <span style="color: #006400">// Make sure that if energyDynamics is SteadyState, then</span>
  <span style="color: #006400">// massDynamics is also SteadyState.</span>
  <span style="color: #006400">// Otherwise, the system of ordinary differential equations may be inconsistent.</span>
  <span style="color: blue">if </span>energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue"> then</span>
    <span style="color: red">assert</span>(massDynamics == energyDynamics, &quot;
         If &#39;massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState&#39;, then it is 
         required that &#39;energyDynamics==Modelica.Fluid.Types.Dynamics.SteadyState&#39;.
         Otherwise, the system of equations may not be consistent.
         You need to select other parameter values.&quot;);
  <span style="color: blue">end if</span>;

  <span style="color: #006400">// initialization of balances</span>
  <span style="color: blue">if </span>energyDynamics == Modelica.Fluid.Types.Dynamics.FixedInitial<span style="color: blue"> then</span>
      medium.T = T_start;
  <span style="color: blue">else</span>
    <span style="color: blue">if </span>energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyStateInitial<span style="color: blue"> then</span>
      <span style="color: red">  der</span>(medium.T) = 0;
    <span style="color: blue">end if</span>;
  <span style="color: blue">end if</span>;

  <span style="color: blue">if </span>massDynamics == Modelica.Fluid.Types.Dynamics.FixedInitial<span style="color: blue"> then</span>
    <span style="color: blue">if </span>initialize_p<span style="color: blue"> then</span>
      medium.p = p_start;
    <span style="color: blue">end if</span>;
  <span style="color: blue">else</span>
    <span style="color: blue">if </span>massDynamics == Modelica.Fluid.Types.Dynamics.SteadyStateInitial<span style="color: blue"> then</span>
      <span style="color: blue">if </span>initialize_p<span style="color: blue"> then</span>
        <span style="color: red">der</span>(medium.p) = 0;
      <span style="color: blue">end if</span>;
    <span style="color: blue">end if</span>;
  <span style="color: blue">end if</span>;

  <span style="color: blue">if </span>substanceDynamics == Modelica.Fluid.Types.Dynamics.FixedInitial<span style="color: blue"> then</span>
    medium.Xi = X_start[1:Medium.nXi];
  <span style="color: blue">else</span>
    <span style="color: blue">if </span>substanceDynamics == Modelica.Fluid.Types.Dynamics.SteadyStateInitial<span style="color: blue"> then</span>
      <span style="color: red">der</span>(medium.Xi) =<span style="color: red"> zeros</span>(Medium.nXi);
    <span style="color: blue">end if</span>;
  <span style="color: blue">end if</span>;

  <span style="color: blue">if </span>traceDynamics == Modelica.Fluid.Types.Dynamics.FixedInitial<span style="color: blue"> then</span>
    C = C_start[1:Medium.nC];
  <span style="color: blue">else</span>
    <span style="color: blue">if </span>traceDynamics == Modelica.Fluid.Types.Dynamics.SteadyStateInitial<span style="color: blue"> then</span>
      <span style="color: red">der</span>(C) =<span style="color: red"> zeros</span>(Medium.nC);
    <span style="color: blue">end if</span>;
  <span style="color: blue">end if</span>;

<span style="color: blue">equation </span>
  <span style="color: #006400">// Total quantities</span>
  m = fluidVolume*medium.d;
  mXi = m*medium.Xi;
  U = m*medium.u;
  mC = m*C;

  hOut = medium.h;
  XiOut = medium.Xi;
  COut = C;

  <span style="color: blue">for </span>i<span style="color: blue"> in </span>1:nPorts<span style="color: blue"> loop</span>
    ports_H_flow[i]     = ports[i].m_flow *<span style="color: red"> actualStream</span>(ports[i].h_outflow) <span style="color: #006400">
      &quot;Enthalpy flow&quot;</span>;
    ports_mXi_flow[i,:] = ports[i].m_flow *<span style="color: red"> actualStream</span>(ports[i].Xi_outflow) <span style="color: #006400">
      &quot;Component mass flow&quot;</span>;
    ports_mC_flow[i,:]  = ports[i].m_flow *<span style="color: red"> actualStream</span>(ports[i].C_outflow) <span style="color: #006400">
      &quot;Trace substance mass flow&quot;</span>;
  <span style="color: blue">end for</span>;

  <span style="color: blue">for </span>i<span style="color: blue"> in </span>1:Medium.nXi<span style="color: blue"> loop</span>
    mbXi_flow[i] =<span style="color: red"> sum</span>(ports_mXi_flow[:,i]);
  <span style="color: blue">end for</span>;

  <span style="color: blue">for </span>i<span style="color: blue"> in </span>1:Medium.nC<span style="color: blue"> loop</span>
    mbC_flow[i]  =<span style="color: red"> sum</span>(ports_mC_flow[:,i]);
  <span style="color: blue">end for</span>;

  mb_flow =<span style="color: red"> sum</span>(ports.m_flow);
  Hb_flow =<span style="color: red"> sum</span>(ports_H_flow);

  <span style="color: #006400">// Energy and mass balances</span>
  <span style="color: blue">if </span>energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue"> then</span>
    0 = Hb_flow + Q_flow;
  <span style="color: blue">else</span>
    <span style="color: red">der</span>(U) = Hb_flow + Q_flow;
  <span style="color: blue">end if</span>;

  <span style="color: blue">if </span>massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue"> then</span>
    0 = mb_flow + mWat_flow;
  <span style="color: blue">else</span>
    <span style="color: red">der</span>(m) = mb_flow + mWat_flow;
  <span style="color: blue">end if</span>;

  <span style="color: blue">if </span>substanceDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue"> then</span>
    <span style="color: red">zeros</span>(Medium.nXi) = mbXi_flow + mWat_flow * s;
  <span style="color: blue">else</span>
    <span style="color: red">der</span>(mXi) = mbXi_flow + mWat_flow * s;
  <span style="color: blue">end if</span>;

  <span style="color: blue">if </span>traceDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue"> then</span>
    <span style="color: red">zeros</span>(Medium.nC)  = mbC_flow;
  <span style="color: blue">else</span>
    <span style="color: red">der</span>(mC)  = mbC_flow;
  <span style="color: blue">end if</span>;

  <span style="color: #006400">// Properties of outgoing flows</span>
  <span style="color: blue">for </span>i<span style="color: blue"> in </span>1:nPorts<span style="color: blue"> loop</span>
      ports[i].p          = medium.p;
      ports[i].h_outflow  = medium.h;
      ports[i].Xi_outflow = medium.Xi;
      ports[i].C_outflow  = C;
  <span style="color: blue">end for</span>;

<span style="color: blue">end </span>ConservationEquation;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE FourPort<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interfaces.FourPortI.png" alt="Buildings.Fluid.Interfaces.FourPort" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.FourPort"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.FourPort</h2>
<p>
<b>Partial model with four ports</b>
<br>
<br><img src="Buildings.Fluid.Interfaces.FourPortD.png" alt="Buildings.Fluid.Interfaces.FourPort">
</p>
<h3>Information</h3>

<p>
This model defines an interface for components with four ports. 
The parameters <code>allowFlowReversal1</code> and
<code>allowFlowReversal2</code> may be used by models that extend
this model to treat flow reversal.
</p>
<p>
This model is identical to 
<a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPort"
>
Modelica.Fluid.Interfaces.PartialTwoPort</a>, except that it has four ports.
</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium1</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium 1 in the component</td></tr>
<tr><td colspan="2">replaceable package Medium2</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium 2 in the component</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal1</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr><td>Boolean</td><td>allowFlowReversal2</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port a1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port b1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port a2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port b2 [J/kg]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium1</td><td>Medium 1 in the component</td></tr>
<tr><td colspan="2">replaceable package Medium2</td><td>Medium 2 in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a1</td><td>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b1</td><td>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a2</td><td>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b2</td><td>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">model</span> FourPort <span style="color: #006400">&quot;Partial model with four ports&quot;</span>

  <span style="color: blue">outer </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid.html#Modelica.Fluid.System"
>Modelica.Fluid.System</a> system <span style="color: #006400">&quot;System wide properties&quot;</span>;

  <span style="color: blue">replaceable </span><span style="color: blue">package</span> Medium1 =
      <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400">&quot;Medium 1 in the component&quot;</span>;
  <span style="color: blue">replaceable </span><span style="color: blue">package</span> Medium2 =
      <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400">&quot;Medium 2 in the component&quot;</span>;

  <span style="color: blue">parameter </span>Boolean allowFlowReversal1 = system.allowFlowReversal <span style="color: #006400">
    &quot;= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)&quot;</span>;
  <span style="color: blue">parameter </span>Boolean allowFlowReversal2 = system.allowFlowReversal <span style="color: #006400">
    &quot;= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)&quot;</span>;

  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h_outflow_a1_start = Medium1.h_default <span style="color: #006400">
    &quot;Start value for enthalpy flowing out of port a1&quot;</span>;

  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h_outflow_b1_start = Medium1.h_default <span style="color: #006400">
    &quot;Start value for enthalpy flowing out of port b1&quot;</span>;

  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h_outflow_a2_start = Medium2.h_default <span style="color: #006400">
    &quot;Start value for enthalpy flowing out of port a2&quot;</span>;

  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h_outflow_b2_start = Medium2.h_default <span style="color: #006400">
    &quot;Start value for enthalpy flowing out of port b2&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>Modelica.Fluid.Interfaces.FluidPort_a</a> port_a1(
                     <span style="color: blue">redeclare </span><span style="color: blue">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium1.html#Buildings.Fluid.Interfaces.FourPort.Medium1"
>Medium1</a>,
                     m_flow(min=<span style="color: blue">if </span>allowFlowReversal1<span style="color: blue"> then </span>-Modelica.Constants.inf<span style="color: blue"> else </span>0),
                     h_outflow(nominal=1E5, start=h_outflow_a1_start),
                     Xi_outflow(<span style="color: blue">each </span>nominal=0.01)) <span style="color: #006400">
    &quot;Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>Modelica.Fluid.Interfaces.FluidPort_b</a> port_b1(
                     <span style="color: blue">redeclare </span><span style="color: blue">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium1.html#Buildings.Fluid.Interfaces.FourPort.Medium1"
>Medium1</a>,
                     m_flow(max=<span style="color: blue">if </span>allowFlowReversal1<span style="color: blue"> then </span>+Modelica.Constants.inf<span style="color: blue"> else </span>0),
                     h_outflow(nominal=1E5, start=h_outflow_b1_start),
                     Xi_outflow(<span style="color: blue">each </span>nominal=0.01)) <span style="color: #006400">
    &quot;Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>Modelica.Fluid.Interfaces.FluidPort_a</a> port_a2(
                     <span style="color: blue">redeclare </span><span style="color: blue">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium2.html#Buildings.Fluid.Interfaces.FourPort.Medium2"
>Medium2</a>,
                     m_flow(min=<span style="color: blue">if </span>allowFlowReversal2<span style="color: blue"> then </span>-Modelica.Constants.inf<span style="color: blue"> else </span>0),
                     h_outflow(nominal=1E5,start=h_outflow_a2_start),
                     Xi_outflow(<span style="color: blue">each </span>nominal=0.01)) <span style="color: #006400">
    &quot;Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>Modelica.Fluid.Interfaces.FluidPort_b</a> port_b2(
                     <span style="color: blue">redeclare </span><span style="color: blue">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium2.html#Buildings.Fluid.Interfaces.FourPort.Medium2"
>Medium2</a>,
                     m_flow(max=<span style="color: blue">if </span>allowFlowReversal2<span style="color: blue"> then </span>+Modelica.Constants.inf<span style="color: blue"> else </span>0),
                     h_outflow(nominal=1E5, start=h_outflow_b2_start),
                     Xi_outflow(<span style="color: blue">each </span>nominal=0.01)) <span style="color: #006400">
    &quot;Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)&quot;</span>;

<span style="color: blue">end </span>FourPort;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE FourPortFlowResistanceParameters<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.FourPortFlowResistanceParameters</h2>
<p>
<b>Parameters for flow resistance for models with four ports</b>
</p>
<h3>Information</h3>

This class contains parameters that are used to
compute the pressure drop in components that have two fluid streams.
Note that the nominal mass flow rate is not declared here because
the model 
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>
PartialFourPortInterface</a>
already declares it.

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp1_nominal</td><td>&nbsp;</td><td>Pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp2_nominal</td><td>&nbsp;</td><td>Pressure [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 1</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance1</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp1</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance1</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM1</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 2</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance2</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp2</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance2</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM2</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">record</span> FourPortFlowResistanceParameters <span style="color: #006400">
  &quot;Parameters for flow resistance for models with four ports&quot;</span>

  <span style="color: blue">parameter </span>Boolean computeFlowResistance1 = true <span style="color: #006400">
    &quot;=true, compute flow resistance. Set to false to assume no friction&quot;</span>;

  <span style="color: blue">parameter </span>Boolean from_dp1 = false <span style="color: #006400">
    &quot;= true, use m_flow = f(dp) else dp = f(m_flow)&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp1_nominal(min=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400">
    &quot;Pressure&quot;</span>;
  <span style="color: blue">parameter </span>Boolean linearizeFlowResistance1 = false <span style="color: #006400">
    &quot;= true, use linear relation between m_flow and dp for any flow rate&quot;</span>;
  <span style="color: blue">parameter </span>Real deltaM1 = 0.1 <span style="color: #006400">
    &quot;Fraction of nominal flow rate where flow transitions to laminar&quot;</span>;
  <span style="color: blue">parameter </span>Boolean computeFlowResistance2 = true <span style="color: #006400">
    &quot;=true, compute flow resistance. Set to false to assume no friction&quot;</span>;

  <span style="color: blue">parameter </span>Boolean from_dp2 = false <span style="color: #006400">
    &quot;= true, use m_flow = f(dp) else dp = f(m_flow)&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp2_nominal(min=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400">
    &quot;Pressure&quot;</span>;
  <span style="color: blue">parameter </span>Boolean linearizeFlowResistance2 = false <span style="color: #006400">
    &quot;= true, use linear relation between m_flow and dp for any flow rate&quot;</span>;
  <span style="color: blue">parameter </span>Real deltaM2 = 0.1 <span style="color: #006400">
    &quot;Fraction of nominal flow rate where flow transitions to laminar&quot;</span>;
<span style="color: blue">end </span>FourPortFlowResistanceParameters;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE FourPortHeatMassExchanger<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interface997284f3a7348477angerI.png" alt="Buildings.Fluid.Interfaces.FourPortHeatMassExchanger" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.FourPortHeatMassExchanger"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.FourPortHeatMassExchanger</h2>
<p>
<b>Model transporting two fluid streams between four ports with storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interface997284f3a7348477angerD.png" alt="Buildings.Fluid.Interfaces.FourPortHeatMassExchanger">
</p>
<h3>Information</h3>

<p>
This component transports two fluid streams between four ports. 
It provides the basic model for implementing a dynamic heat exchanger.
</p>
<p>
The model can be used as-is, although there will be no heat or mass transfer
between the two fluid streams. 
To add heat transfer, heat flow can be added to the heat port of the two volumes.
See for example
<a href="Buildings_Fluid_Chillers.html#Buildings.Fluid.Chillers.Carnot"
>
Buildings.Fluid.Chillers.Carnot</a>.
To add moisture input into (or moisture output from) volume <code>vol2</code>,
the model can be replaced as shown in
<a href="modelica://Buildings.Fluid.HeatExchangers.BaseClasses.HexElement">
Buildings.Fluid.HeatExchangers.BaseClasses.HexElement</a>.
</p>
<h4>Implementation</h4>
<p>
The variable names follow the conventions used in 
<a href="modelica://Modelica.Fluid.HeatExchangers.BasicHX">
Modelica.Fluid.HeatExchangers.BasicHX</a>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</a> (Partial model transporting fluid between two ports without storing mass or energy), <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters</a> (Parameters for flow resistance for models with four ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium1</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 1 in the component</td></tr>
<tr><td colspan="2">replaceable package Medium2</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 2 in the component</td></tr>
<tr><td><a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>MixingVolume</a></td><td>vol2</td><td>redeclare Buildings.Fluid.Mi...</td><td>Volume for fluid 2</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp1_nominal</td><td>&nbsp;</td><td>Pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp2_nominal</td><td>&nbsp;</td><td>Pressure [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow.start</td><td>0</td><td>Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp1.start</td><td>0</td><td>Pressure difference between port_a1 and port_b1 [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow.start</td><td>0</td><td>Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp2.start</td><td>0</td><td>Pressure difference between port_a2 and port_b2 [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal1</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr><td>Boolean</td><td>allowFlowReversal2</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a1_start</td><td>h1_outflow_start</td><td>Start value for enthalpy flowing out of port a1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b1_start</td><td>h1_outflow_start</td><td>Start value for enthalpy flowing out of port b1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a2_start</td><td>h2_outflow_start</td><td>Start value for enthalpy flowing out of port a2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b2_start</td><td>h2_outflow_start</td><td>Start value for enthalpy flowing out of port b2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_small</td><td>1E-4*abs(m1_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_small</td><td>1E-4*abs(m2_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 1</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance1</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp1</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance1</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM1</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 2</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance2</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp2</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance2</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM2</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau1</td><td>30</td><td>Time constant at nominal flow [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau2</td><td>30</td><td>Time constant at nominal flow [s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 1</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p1_start</td><td>Medium1.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T1_start</td><td>Medium1.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X1_start[Medium1.nX]</td><td>Medium1.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C1_start[Medium1.nC]</td><td>fill(0, Medium1.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C1_nominal[Medium1.nC]</td><td>fill(1E-2, Medium1.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 2</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p2_start</td><td>Medium2.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T2_start</td><td>Medium2.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X2_start[Medium2.nX]</td><td>Medium2.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C2_start[Medium2.nC]</td><td>fill(0, Medium2.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C2_nominal[Medium2.nC]</td><td>fill(1E-2, Medium2.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a1</td><td>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b1</td><td>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a2</td><td>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b2</td><td>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">model</span> FourPortHeatMassExchanger <span style="color: #006400">
  &quot;Model transporting two fluid streams between four ports with storing mass or energy&quot;</span>
  <span style="color: blue">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</a>(
    <span style="color: blue">final </span>h_outflow_a1_start = h1_outflow_start,
    <span style="color: blue">final </span>h_outflow_b1_start = h1_outflow_start,
    <span style="color: blue">final </span>h_outflow_a2_start = h2_outflow_start,
    <span style="color: blue">final </span>h_outflow_b2_start = h2_outflow_start);
  <span style="color: blue">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters</a>(
     <span style="color: blue">final </span>computeFlowResistance1=true, <span style="color: blue">final </span>computeFlowResistance2=true);

  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> tau1 = 30 <span style="color: #006400">&quot;Time constant at nominal flow&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> tau2 = 30 <span style="color: #006400">&quot;Time constant at nominal flow&quot;</span>;

  <span style="color: #006400">// Advanced</span>
  <span style="color: blue">parameter </span>Boolean homotopyInitialization = true <span style="color: #006400">&quot;= true, use homotopy method&quot;</span>;

  <span style="color: #006400">// Assumptions</span>
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> energyDynamics=Modelica.Fluid.Types.Dynamics.DynamicFreeInitial <span style="color: #006400">
    &quot;Formulation of energy balance&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> massDynamics=energyDynamics <span style="color: #006400">
    &quot;Formulation of mass balance&quot;</span>;

  <span style="color: #006400">// Initialization</span>
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>Medium1.AbsolutePressure</a> p1_start = Medium1.p_default <span style="color: #006400">
    &quot;Start value of pressure&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Medium1.Temperature</a> T1_start = Medium1.T_default <span style="color: #006400">
    &quot;Start value of temperature&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>Medium1.MassFraction</a> X1_start[Medium1.nX] = Medium1.X_default <span style="color: #006400">
    &quot;Start value of mass fractions m_i/m&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium1.ExtraProperty</a> C1_start[Medium1.nC](
       quantity=Medium1.extraPropertiesNames)=<span style="color: red">fill</span>(0, Medium1.nC) <span style="color: #006400">
    &quot;Start value of trace substances&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium1.ExtraProperty</a> C1_nominal[Medium1.nC](
       quantity=Medium1.extraPropertiesNames) =<span style="color: red"> fill</span>(1E-2, Medium1.nC) <span style="color: #006400">
    &quot;Nominal value of trace substances. (Set to typical order of magnitude.)&quot;</span>;

  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>Medium2.AbsolutePressure</a> p2_start = Medium2.p_default <span style="color: #006400">
    &quot;Start value of pressure&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Medium2.Temperature</a> T2_start = Medium2.T_default <span style="color: #006400">
    &quot;Start value of temperature&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>Medium2.MassFraction</a> X2_start[Medium2.nX] = Medium2.X_default <span style="color: #006400">
    &quot;Start value of mass fractions m_i/m&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium2.ExtraProperty</a> C2_start[Medium2.nC](
       quantity=Medium2.extraPropertiesNames)=<span style="color: red">fill</span>(0, Medium2.nC) <span style="color: #006400">
    &quot;Start value of trace substances&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium2.ExtraProperty</a> C2_nominal[Medium2.nC](
       quantity=Medium2.extraPropertiesNames) =<span style="color: red"> fill</span>(1E-2, Medium2.nC) <span style="color: #006400">
    &quot;Nominal value of trace substances. (Set to typical order of magnitude.)&quot;</span>;

  <a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>Buildings.Fluid.MixingVolumes.MixingVolume</a> vol1(
    <span style="color: blue">redeclare </span><span style="color: blue">final </span><span style="color: blue">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium1.html#Buildings.Fluid.Interfaces.FourPort.Medium1"
>Medium1</a>,
    nPorts = 2,
    V=m1_flow_nominal*tau1/rho1_nominal,
    <span style="color: blue">final </span>m_flow_nominal=m1_flow_nominal,
    energyDynamics=<span style="color: blue">if </span>tau1 &gt; Modelica.Constants.eps<span style="color: blue">
                         then </span>energyDynamics<span style="color: blue"> else </span>
                         Modelica.Fluid.Types.Dynamics.SteadyState,
    massDynamics=<span style="color: blue">if </span>tau1 &gt; Modelica.Constants.eps<span style="color: blue">
                         then </span>massDynamics<span style="color: blue"> else </span>
                         Modelica.Fluid.Types.Dynamics.SteadyState,
    <span style="color: blue">final </span>p_start=p1_start,
    <span style="color: blue">final </span>T_start=T1_start,
    <span style="color: blue">final </span>X_start=X1_start,
    <span style="color: blue">final </span>C_start=C1_start,
    <span style="color: blue">final </span>C_nominal=C1_nominal) <span style="color: #006400">&quot;Volume for fluid 1&quot;</span>;

  <span style="color: blue">replaceable </span><a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>Buildings.Fluid.MixingVolumes.MixingVolume</a> vol2
    <span style="color: blue">constrainedby </span>Buildings.Fluid.MixingVolumes.BaseClasses.PartialMixingVolume(
    <span style="color: blue">redeclare </span><span style="color: blue">final </span><span style="color: blue">package</span> Medium = Medium2,
    nPorts = 2,
    V=m2_flow_nominal*tau2/rho2_nominal,
    <span style="color: blue">final </span>m_flow_nominal = m2_flow_nominal,
    energyDynamics=<span style="color: blue">if </span>tau2 &gt; Modelica.Constants.eps<span style="color: blue">
                         then </span>energyDynamics<span style="color: blue"> else </span>
                         Modelica.Fluid.Types.Dynamics.SteadyState,
    massDynamics=<span style="color: blue">if </span>tau2 &gt; Modelica.Constants.eps<span style="color: blue">
                         then </span>massDynamics<span style="color: blue"> else </span>
                         Modelica.Fluid.Types.Dynamics.SteadyState,
    <span style="color: blue">final </span>p_start=p2_start,
    <span style="color: blue">final </span>T_start=T2_start,
    <span style="color: blue">final </span>X_start=X2_start,
    <span style="color: blue">final </span>C_start=C2_start,
    <span style="color: blue">final </span>C_nominal=C2_nominal) <span style="color: #006400">&quot;Volume for fluid 2&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q1_flow = vol1.heatPort.Q_flow <span style="color: #006400">
    &quot;Heat flow rate into medium 1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q2_flow = vol2.heatPort.Q_flow <span style="color: #006400">
    &quot;Heat flow rate into medium 2&quot;</span>;

  <a href="Buildings_Fluid_FixedResistances.html#Buildings.Fluid.FixedResistances.FixedResistanceDpM"
>Buildings.Fluid.FixedResistances.FixedResistanceDpM</a> preDro1(
    <span style="color: blue">redeclare </span><span style="color: blue">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium1.html#Buildings.Fluid.Interfaces.FourPort.Medium1"
>Medium1</a>,
    <span style="color: blue">final </span>use_dh=false,
    <span style="color: blue">final </span>m_flow_nominal=m1_flow_nominal,
    <span style="color: blue">final </span>deltaM=deltaM1,
    <span style="color: blue">final </span>allowFlowReversal=allowFlowReversal1,
    <span style="color: blue">final </span>show_T=false,
    <span style="color: blue">final </span>from_dp=from_dp1,
    <span style="color: blue">final </span>linearized=linearizeFlowResistance1,
    <span style="color: blue">final </span>homotopyInitialization=homotopyInitialization,
    <span style="color: blue">final </span>dp_nominal=dp1_nominal,
    <span style="color: blue">final </span>dh=1,
    <span style="color: blue">final </span>ReC=4000) <span style="color: #006400">&quot;Pressure drop model for fluid 1&quot;</span>;

  <a href="Buildings_Fluid_FixedResistances.html#Buildings.Fluid.FixedResistances.FixedResistanceDpM"
>Buildings.Fluid.FixedResistances.FixedResistanceDpM</a> preDro2(
    <span style="color: blue">redeclare </span><span style="color: blue">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium2.html#Buildings.Fluid.Interfaces.FourPort.Medium2"
>Medium2</a>,
    <span style="color: blue">final </span>use_dh=false,
    <span style="color: blue">final </span>m_flow_nominal=m2_flow_nominal,
    <span style="color: blue">final </span>deltaM=deltaM2,
    <span style="color: blue">final </span>allowFlowReversal=allowFlowReversal2,
    <span style="color: blue">final </span>show_T=false,
    <span style="color: blue">final </span>from_dp=from_dp2,
    <span style="color: blue">final </span>linearized=linearizeFlowResistance2,
    <span style="color: blue">final </span>homotopyInitialization=homotopyInitialization,
    <span style="color: blue">final </span>dp_nominal=dp2_nominal,
    <span style="color: blue">final </span>dh=1,
    <span style="color: blue">final </span>ReC=4000) <span style="color: #006400">&quot;Pressure drop model for fluid 2&quot;</span>;

<span style="color: blue">protected </span>
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> sta1_nominal=<span style="color: red">Medium1.setState_pTX</span>(
      T=Medium1.T_default, p=Medium1.p_default, X=Medium1.X_default);
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho1_nominal=<span style="color: red">Medium1.density</span>(sta1_nominal) <span style="color: #006400">
    &quot;Density, used to compute fluid volume&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> sta2_nominal=<span style="color: red">Medium2.setState_pTX</span>(
      T=Medium2.T_default, p=Medium2.p_default, X=Medium2.X_default);
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho2_nominal=<span style="color: red">Medium2.density</span>(sta2_nominal) <span style="color: #006400">
    &quot;Density, used to compute fluid volume&quot;</span>;

  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> sta1_start=<span style="color: red">Medium1.setState_pTX</span>(
      T=T1_start, p=p1_start, X=X1_start);
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h1_outflow_start =<span style="color: red"> Medium1.specificEnthalpy</span>(sta1_start) <span style="color: #006400">
    &quot;Start value for outflowing enthalpy&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> sta2_start=<span style="color: red">Medium2.setState_pTX</span>(
      T=T2_start, p=p2_start, X=X2_start);
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h2_outflow_start =<span style="color: red"> Medium2.specificEnthalpy</span>(sta2_start) <span style="color: #006400">
    &quot;Start value for outflowing enthalpy&quot;</span>;

<span style="color: blue">initial </span><span style="color: blue">algorithm </span>
  <span style="color: #006400">// Check for tau1</span>
  <span style="color: red">assert</span>((energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue"> or </span>
          tau1 &gt; Modelica.Constants.eps,
&quot;The parameter tau1, or the volume of the model from which tau may be derived, is unreasonably small.
 You need to set energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau1 = &quot; +<span style="color: red"> String</span>(tau1) + &quot;\n&quot;);
  <span style="color: red">assert</span>((massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue"> or </span>
          tau1 &gt; Modelica.Constants.eps,
&quot;The parameter tau1, or the volume of the model from which tau may be derived, is unreasonably small.          
 You need to set massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau1 = &quot; +<span style="color: red"> String</span>(tau1) + &quot;\n&quot;);

 <span style="color: #006400">// Check for tau2</span>
  <span style="color: red">assert</span>((energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue"> or </span>
          tau2 &gt; Modelica.Constants.eps,
&quot;The parameter tau2, or the volume of the model from which tau may be derived, is unreasonably small.
 You need to set energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau2 = &quot; +<span style="color: red"> String</span>(tau2) + &quot;\n&quot;);
  <span style="color: red">assert</span>((massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue"> or </span>
          tau2 &gt; Modelica.Constants.eps,
&quot;The parameter tau2, or the volume of the model from which tau may be derived, is unreasonably small.          
 You need to set massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau2 = &quot; +<span style="color: red"> String</span>(tau2) + &quot;\n&quot;);
<span style="color: blue">equation </span>
  <span style="color: red">connect</span>(vol1.ports[2], port_b1);
  <span style="color: red">connect</span>(vol2.ports[2], port_b2);
  <span style="color: red">connect</span>(port_a1, preDro1.port_a);
  <span style="color: red">connect</span>(preDro1.port_b, vol1.ports[1]);
  <span style="color: red">connect</span>(port_a2, preDro2.port_a);
  <span style="color: red">connect</span>(preDro2.port_b, vol2.ports[1]);
<span style="color: blue">end </span>FourPortHeatMassExchanger;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE LumpedVolumeDeclarations<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.LumpedVolumeDeclarations</h2>
<p>
<b>Declarations for lumped volumes</b>
</p>
<h3>Information</h3>

<p>
This class contains parameters and medium properties
that are used in the lumped  volume model, and in models that extend the 
lumped volume model.
</p>
<p>
These parameters are used by
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.ConservationEquation"
>
Buildings.Fluid.Interfaces.ConservationEquation</a>,
<a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>
Buildings.Fluid.MixingVolumes.MixingVolume</a>,
<a href="Buildings_Rooms.html#Buildings.Rooms.MixedAir"
>
Buildings.Rooms.MixedAir</a>, and by
<a href="modelica://Buildings.Rooms.BaseClasses.MixedAir">
Buildings.Rooms.BaseClasses.MixedAir</a>.
</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium in the component</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_nominal[Medium.nC]</td><td>fill(1E-2, Medium.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">record</span> LumpedVolumeDeclarations <span style="color: #006400">&quot;Declarations for lumped volumes&quot;</span>
  <span style="color: blue">replaceable </span><span style="color: blue">package</span> Medium =
    <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400">&quot;Medium in the component&quot;</span>;

  <span style="color: #006400">// Assumptions</span>
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> energyDynamics=Modelica.Fluid.Types.Dynamics.DynamicFreeInitial <span style="color: #006400">
    &quot;Formulation of energy balance&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> massDynamics=energyDynamics <span style="color: #006400">
    &quot;Formulation of mass balance&quot;</span>;
  <span style="color: blue">final </span><span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> substanceDynamics=energyDynamics <span style="color: #006400">
    &quot;Formulation of substance balance&quot;</span>;
  <span style="color: blue">final </span><span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> traceDynamics=energyDynamics <span style="color: #006400">
    &quot;Formulation of trace substance balance&quot;</span>;

  <span style="color: #006400">// Initialization</span>
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>Medium.AbsolutePressure</a> p_start = Medium.p_default <span style="color: #006400">
    &quot;Start value of pressure&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Medium.Temperature</a> T_start=Medium.T_default <span style="color: #006400">
    &quot;Start value of temperature&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>Medium.MassFraction</a> X_start[Medium.nX] = Medium.X_default <span style="color: #006400">
    &quot;Start value of mass fractions m_i/m&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium.ExtraProperty</a> C_start[Medium.nC](
       quantity=Medium.extraPropertiesNames)=<span style="color: red">fill</span>(0, Medium.nC) <span style="color: #006400">
    &quot;Start value of trace substances&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium.ExtraProperty</a> C_nominal[Medium.nC](
       quantity=Medium.extraPropertiesNames) =<span style="color: red"> fill</span>(1E-2, Medium.nC) <span style="color: #006400">
    &quot;Nominal value of trace substances. (Set to typical order of magnitude.)&quot;</span>;

<span style="color: blue">end </span>LumpedVolumeDeclarations;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialFourPortInterface<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interface0bf626e24a9671a0rfaceI.png" alt="Buildings.Fluid.Interfaces.PartialFourPortInterface" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.PartialFourPortInterface"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.PartialFourPortInterface</h2>
<p>
<b>Partial model transporting fluid between two ports without storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interface0bf626e24a9671a0rfaceD.png" alt="Buildings.Fluid.Interfaces.PartialFourPortInterface">
</p>
<h3>Information</h3>

<p>
This component defines the interface for models that 
transport two fluid streams between four ports. 
It is similar to 
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>
Buildings.Fluid.Interfaces.PartialTwoPortInterface</a>,
but it has four ports instead of two.
<p>
The model is used by other models in this package that add heat transfer,
mass transfer and pressure drop equations.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPort"
>Buildings.Fluid.Interfaces.FourPort</a> (Partial model with four ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium1</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 1 in the component</td></tr>
<tr><td colspan="2">replaceable package Medium2</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 2 in the component</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal1</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr><td>Boolean</td><td>allowFlowReversal2</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port a1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port b1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port a2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port b2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_small</td><td>1E-4*abs(m1_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_small</td><td>1E-4*abs(m2_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a1</td><td>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b1</td><td>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a2</td><td>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b2</td><td>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">partial </span><span style="color: blue">model</span> PartialFourPortInterface <span style="color: #006400">
  &quot;Partial model transporting fluid between two ports without storing mass or energy&quot;</span>
  <span style="color: blue">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPort"
>Buildings.Fluid.Interfaces.FourPort</a>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m1_flow_nominal(min=0) <span style="color: #006400">
    &quot;Nominal mass flow rate&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m2_flow_nominal(min=0) <span style="color: #006400">
    &quot;Nominal mass flow rate&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium1.MassFlowRate</a> m1_flow_small(min=0) = 1E-4*<span style="color: red">abs</span>(m1_flow_nominal) <span style="color: #006400">
    &quot;Small mass flow rate for regularization of zero flow&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium2.MassFlowRate</a> m2_flow_small(min=0) = 1E-4*<span style="color: red">abs</span>(m2_flow_nominal) <span style="color: #006400">
    &quot;Small mass flow rate for regularization of zero flow&quot;</span>;
  <span style="color: #006400">// Diagnostics</span>
  <span style="color: blue">parameter </span>Boolean show_T = false <span style="color: #006400">
    &quot;= true, if actual temperature at port is computed&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium1.MassFlowRate</a> m1_flow(start=0) = port_a1.m_flow <span style="color: #006400">
    &quot;Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp1(start=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400">
    &quot;Pressure difference between port_a1 and port_b1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium2.MassFlowRate</a> m2_flow(start=0) = port_a2.m_flow <span style="color: #006400">
    &quot;Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp2(start=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400">
    &quot;Pressure difference between port_a2 and port_b2&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> sta_a1=
      <span style="color: red">Medium1.setState_phX</span>(port_a1.p,
                           <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_a1.h_outflow)),
                           <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_a1.Xi_outflow))) <span style="color: blue">if </span>
         show_T <span style="color: #006400">&quot;Medium properties in port_a1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> sta_b1=
      <span style="color: red">Medium1.setState_phX</span>(port_b1.p,
                           <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_b1.h_outflow)),
                           <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_b1.Xi_outflow))) <span style="color: blue">if </span>
         show_T <span style="color: #006400">&quot;Medium properties in port_b1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> sta_a2=
      <span style="color: red">Medium2.setState_phX</span>(port_a2.p,
                           <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_a2.h_outflow)),
                           <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_a2.Xi_outflow))) <span style="color: blue">if </span>
         show_T <span style="color: #006400">&quot;Medium properties in port_a2&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> sta_b2=
      <span style="color: red">Medium2.setState_phX</span>(port_b2.p,
                           <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_b2.h_outflow)),
                           <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_b2.Xi_outflow))) <span style="color: blue">if </span>
         show_T <span style="color: #006400">&quot;Medium properties in port_b2&quot;</span>;
<span style="color: blue">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> state_a1_inflow=
    <span style="color: red">Medium1.setState_phX</span>(port_a1.p,<span style="color: red"> inStream</span>(port_a1.h_outflow),<span style="color: red"> inStream</span>(port_a1.Xi_outflow)) <span style="color: #006400">
    &quot;state for medium inflowing through port_a1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> state_b1_inflow=
    <span style="color: red">Medium1.setState_phX</span>(port_b1.p,<span style="color: red"> inStream</span>(port_b1.h_outflow),<span style="color: red"> inStream</span>(port_b1.Xi_outflow)) <span style="color: #006400">
    &quot;state for medium inflowing through port_b1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> state_a2_inflow=
    <span style="color: red">Medium2.setState_phX</span>(port_a2.p,<span style="color: red"> inStream</span>(port_a2.h_outflow),<span style="color: red"> inStream</span>(port_a2.Xi_outflow)) <span style="color: #006400">
    &quot;state for medium inflowing through port_a2&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> state_b2_inflow=
    <span style="color: red">Medium2.setState_phX</span>(port_b2.p,<span style="color: red"> inStream</span>(port_b2.h_outflow),<span style="color: red"> inStream</span>(port_b2.Xi_outflow)) <span style="color: #006400">
    &quot;state for medium inflowing through port_b2&quot;</span>;
<span style="color: blue">equation </span>
  dp1 = port_a1.p - port_b1.p;
  dp2 = port_a2.p - port_b2.p;
<span style="color: blue">end </span>PartialFourPortInterface;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialTwoPortInterface<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interfacece5744ecb2dac5c0rfaceI.png" alt="Buildings.Fluid.Interfaces.PartialTwoPortInterface" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.PartialTwoPortInterface"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.PartialTwoPortInterface</h2>
<p>
<b>Partial model transporting fluid between two ports without storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interfacece5744ecb2dac5c0rfaceD.png" alt="Buildings.Fluid.Interfaces.PartialTwoPortInterface">
</p>
<h3>Information</h3>

<p>
This component defines the interface for models that 
transports a fluid between two ports. It is similar to 
<a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPortTransport"
>
Modelica.Fluid.Interfaces.PartialTwoPortTransport</a>, but it does not 
include the species balance
</p> 
<pre>
  port_b.Xi_outflow = inStream(port_a.Xi_outflow);
</pre>
<p>
Thus, it can be used as a base class for a heat <i>and</i> mass transfer component
</p>
<p>
The model is used by other models in this package that add heat transfer,
mass transfer and pressure drop equations. See for example
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"
>
Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger</a>.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPort"
>Modelica.Fluid.Interfaces.PartialTwoPort</a> (Partial component with two ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_small</td><td>1E-4*abs(m_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">partial </span><span style="color: blue">model</span> PartialTwoPortInterface <span style="color: #006400">
  &quot;Partial model transporting fluid between two ports without storing mass or energy&quot;</span>
  <span style="color: blue">extends </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPort"
>Modelica.Fluid.Interfaces.PartialTwoPort</a>(
    port_a(p(start=Medium.p_default,
             nominal=Medium.p_default)),
    port_b(p(start=Medium.p_default,
           nominal=Medium.p_default)));

  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_nominal <span style="color: #006400">
    &quot;Nominal mass flow rate&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_small(min=0) = 1E-4*<span style="color: red">abs</span>(m_flow_nominal) <span style="color: #006400">
    &quot;Small mass flow rate for regularization of zero flow&quot;</span>;
  <span style="color: #006400">// Diagnostics</span>
   <span style="color: blue">parameter </span>Boolean show_T = false <span style="color: #006400">
    &quot;= true, if actual temperature at port is computed&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow(start=0) = port_a.m_flow <span style="color: #006400">
    &quot;Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp(start=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400">
    &quot;Pressure difference between port_a and port_b&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> sta_a=
      <span style="color: red">Medium.setState_phX</span>(port_a.p,
                          <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_a.h_outflow)),
                          <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_a.Xi_outflow))) <span style="color: blue">if </span>
         show_T <span style="color: #006400">&quot;Medium properties in port_a&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> sta_b=
      <span style="color: red">Medium.setState_phX</span>(port_b.p,
                          <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_b.h_outflow)),
                          <span style="color: red">noEvent</span>(<span style="color: red">actualStream</span>(port_b.Xi_outflow))) <span style="color: blue">if </span>
          show_T <span style="color: #006400">&quot;Medium properties in port_b&quot;</span>;
<span style="color: blue">equation </span>
  dp = port_a.p - port_b.p;
<span style="color: blue">end </span>PartialTwoPortInterface;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE StaticFourPortHeatMassExchanger<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interfacecfb0ac59541ba4f9angerI.png" alt="Buildings.Fluid.Interfaces.StaticFourPortHeatMassExchanger" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.StaticFourPortHeatMassExchanger"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.StaticFourPortHeatMassExchanger</h2>
<p>
<b>Partial model transporting two fluid streams between four ports without storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interfacecfb0ac59541ba4f9angerD.png" alt="Buildings.Fluid.Interfaces.StaticFourPortHeatMassExchanger">
</p>
<h3>Information</h3>

<p>
This component transports two fluid streams between four ports, without
storing mass or energy. It is similar to
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"
>
Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger</a>,
but it has four ports instead of two.
</p>
<p>
If <code>dp<i>N</i>_nominal &gt; Modelica.Constants.eps</code>, 
where <code><i>N</i></code> denotes the fluid <i>1</i> or <i>2</i>,
then the model computes
pressure drop due to flow friction in the respective fluid stream.
The pressure drop is defined by a quadratic function that goes through
the point <code>(m<i>N</i>_flow_nominal, dp<i>N</i>_nominal)</code>. 
At <code>|m<i>N</i>_flow| &lt; deltaM<i>N</i> * m<i>N</i>_flow_nominal</code>,
the pressure drop vs. flow relation is linearized.
If the parameter <code>linearizeFlowResistance<i>N</i></code> is set to true,
then the whole pressure drop vs. flow resistance curve is linearized.
</p>

<h4>Implementation</h4>
<p>
This model uses inputs and constants that need to be set by models
that extend or instantiate this model.
The following inputs need to be assigned, where <code><i>N</i></code> denotes <code>1</code> or
<code>2</code>:</p>
<ul>
<li>
<code>Q<i>N</i>_flow</code>, which is the heat flow rate added to the medium <i>N</i>.
</li>
<li>
<code>mWat<i>N</i>_flow</code>, which is the moisture mass flow rate added to the medium <i>N</i>.
</li>
</ul>
<p>
Set the constant <code>sensibleOnly<i>N</i>=true</code> if the model that extends
or instantiates this model sets <code>mWat<i>N</i>_flow = 0</code>.
</p>
<p>
     Note that the model does not implement <code>0 = Q1_flow + Q2_flow</code> or
     <code>0 = mXi1_flow + mXi2_flow</code>. If there is no heat or mass transfer
     with the environment, then a model that extends this model needs to provide these 
     equations.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</a> (Partial model transporting fluid between two ports without storing mass or energy), <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters</a> (Parameters for flow resistance for models with four ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium1</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 1 in the component</td></tr>
<tr><td colspan="2">replaceable package Medium2</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 2 in the component</td></tr>
<tr><td>Boolean</td><td>sensibleOnly1</td><td>&nbsp;</td><td>Set to true if sensible exchange only for medium 1</td></tr>
<tr><td>Boolean</td><td>sensibleOnly2</td><td>&nbsp;</td><td>Set to true if sensible exchange only for medium 2</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp1_nominal</td><td>&nbsp;</td><td>Pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp2_nominal</td><td>&nbsp;</td><td>Pressure [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow.start</td><td>0</td><td>Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp1.start</td><td>0</td><td>Pressure difference between port_a1 and port_b1 [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow.start</td><td>0</td><td>Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp2.start</td><td>0</td><td>Pressure difference between port_a2 and port_b2 [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal1</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr><td>Boolean</td><td>allowFlowReversal2</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port a1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port b1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port a2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port b2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_small</td><td>1E-4*abs(m1_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_small</td><td>1E-4*abs(m2_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 1</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance1</td><td>(dp1_nominal &gt; Modelica.Cons...</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp1</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance1</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM1</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 2</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance2</td><td>(dp2_nominal &gt; Modelica.Cons...</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp2</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance2</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM2</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a1</td><td>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b1</td><td>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a2</td><td>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b2</td><td>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">model</span> StaticFourPortHeatMassExchanger <span style="color: #006400">
  &quot;Partial model transporting two fluid streams between four ports without storing mass or energy&quot;</span>
  <span style="color: blue">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</a>;
  <span style="color: blue">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters</a>(
   <span style="color: blue">final </span>computeFlowResistance1=(dp1_nominal &gt; Modelica.Constants.eps),
   <span style="color: blue">final </span>computeFlowResistance2=(dp2_nominal &gt; Modelica.Constants.eps));

  <span style="color: blue">parameter </span>Boolean homotopyInitialization = true <span style="color: #006400">&quot;= true, use homotopy method&quot;</span>;

  <span style="color: blue">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q1_flow <span style="color: #006400">
    &quot;Heat transfered into the medium 1&quot;</span>;
  <span style="color: blue">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium1.MassFlowRate</a> mWat1_flow <span style="color: #006400">
    &quot;Moisture mass flow rate added to the medium 1&quot;</span>;
  <span style="color: blue">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q2_flow <span style="color: #006400">
    &quot;Heat transfered into the medium 2&quot;</span>;
  <span style="color: blue">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium2.MassFlowRate</a> mWat2_flow <span style="color: #006400">
    &quot;Moisture mass flow rate added to the medium 2&quot;</span>;
  <span style="color: blue">constant </span>Boolean sensibleOnly1 <span style="color: #006400">
    &quot;Set to true if sensible exchange only for medium 1&quot;</span>;
  <span style="color: blue">constant </span>Boolean sensibleOnly2 <span style="color: #006400">
    &quot;Set to true if sensible exchange only for medium 2&quot;</span>;
<span style="color: blue">protected </span>
  <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"
>Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger</a> bal1(
    <span style="color: blue">final </span>sensibleOnly = sensibleOnly1,
    <span style="color: blue">redeclare </span><span style="color: blue">final </span><span style="color: blue">package</span> Medium=<a href="Buildings_Fluid_Interfaces_Medium1.html#Buildings.Fluid.Interfaces.FourPort.Medium1"
>Medium1</a>,
    <span style="color: blue">final </span>m_flow_nominal = m1_flow_nominal,
    <span style="color: blue">final </span>dp_nominal = dp1_nominal,
    <span style="color: blue">final </span>allowFlowReversal = allowFlowReversal1,
    <span style="color: blue">final </span>m_flow_small = m1_flow_small,
    <span style="color: blue">final </span>homotopyInitialization = homotopyInitialization,
    <span style="color: blue">final </span>from_dp = from_dp1,
    <span style="color: blue">final </span>linearizeFlowResistance = linearizeFlowResistance1,
    <span style="color: blue">final </span>deltaM = deltaM1,
    <span style="color: blue">final </span>Q_flow = Q1_flow,
    <span style="color: blue">final </span>mWat_flow = mWat1_flow) <span style="color: #006400">
    &quot;Model for heat, mass, species, trace substance and pressure balance of stream 1&quot;</span>;
  <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"
>Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger</a> bal2(
    <span style="color: blue">final </span>sensibleOnly = sensibleOnly2,
    <span style="color: blue">redeclare </span><span style="color: blue">final </span><span style="color: blue">package</span> Medium=<a href="Buildings_Fluid_Interfaces_Medium2.html#Buildings.Fluid.Interfaces.FourPort.Medium2"
>Medium2</a>,
    <span style="color: blue">final </span>m_flow_nominal = m2_flow_nominal,
    <span style="color: blue">final </span>dp_nominal = dp2_nominal,
    <span style="color: blue">final </span>allowFlowReversal = allowFlowReversal2,
    <span style="color: blue">final </span>m_flow_small = m2_flow_small,
    <span style="color: blue">final </span>homotopyInitialization = homotopyInitialization,
    <span style="color: blue">final </span>from_dp = from_dp2,
    <span style="color: blue">final </span>linearizeFlowResistance = linearizeFlowResistance2,
    <span style="color: blue">final </span>deltaM = deltaM2,
    <span style="color: blue">final </span>Q_flow = Q2_flow,
    <span style="color: blue">final </span>mWat_flow = mWat2_flow) <span style="color: #006400">
    &quot;Model for heat, mass, species, trace substance and pressure balance of stream 2&quot;</span>;
<span style="color: blue">equation </span>
  <span style="color: red">connect</span>(bal1.port_a, port_a1);
  <span style="color: red">connect</span>(bal1.port_b, port_b1);
  <span style="color: red">connect</span>(bal2.port_a, port_a2);
  <span style="color: red">connect</span>(bal2.port_b, port_b2);
<span style="color: blue">end </span>StaticFourPortHeatMassExchanger;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE StaticTwoPortConservationEquation<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interfacea868bbaf7da4f56dationI.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.StaticTwoPortConservationEquation</h2>
<p>
<b>Partial model for static energy and mass conservation equations</b>
<br>
<br><img src="Buildings.Fluid.Interfacea868bbaf7da4f56dationD.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation">
</p>
<h3>Information</h3>

<p>
This model transports fluid between its two ports, without storing mass or energy. 
It implements a steady-state conservation equation for energy and mass fractions.
The model has zero pressure drop between its ports.
</p>
<h4>Implementation</h4>
Input connectors of the model are
<ul>
<li>
<code>Q_flow</code>, which is the sensible plus latent heat flow rate added to the medium, and
</li>
<li>
<code>mWat_flow</code>, which is the moisture mass flow rate added to the medium.
</li>
</ul>

<p>
The model can only be used as a steady-state model with two fluid ports.
For a model with a dynamic balance, and more fluid ports, use
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.ConservationEquation"
>
Buildings.Fluid.Interfaces.ConservationEquation</a>.
</p>
<p>
Set the constant <code>sensibleOnly=true</code> if the model that extends
or instantiates this model sets <code>mWat_flow = 0</code>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a> (Partial model transporting fluid between two ports without storing mass or energy).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Boolean</td><td>sensibleOnly</td><td>&nbsp;</td><td>Set to true if sensible exchange only</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_small</td><td>1E-4*abs(m_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>Q_flow</td><td>Sensible plus latent heat flow rate transfered into the medium [W]</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>mWat_flow</td><td>Moisture mass flow rate added to the medium [kg/s]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>hOut</td><td>Leaving temperature of the component [J/kg]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>XiOut[Medium.nXi]</td><td>Leaving species concentration of the component [1]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>COut[Medium.nC]</td><td>Leaving trace substances of the component</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">model</span> StaticTwoPortConservationEquation <span style="color: #006400">
  &quot;Partial model for static energy and mass conservation equations&quot;</span>
  <span style="color: blue">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a>(
  showDesignFlowDirection = false);

  <span style="color: blue">constant </span>Boolean sensibleOnly <span style="color: #006400">&quot;Set to true if sensible exchange only&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> Q_flow(unit=&quot;W&quot;) <span style="color: #006400">
    &quot;Sensible plus latent heat flow rate transfered into the medium&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> mWat_flow(unit=&quot;kg/s&quot;) <span style="color: #006400">
    &quot;Moisture mass flow rate added to the medium&quot;</span>;

  <span style="color: #006400">// Outputs that are needed in models that extend this model</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> hOut(unit=&quot;J/kg&quot;,
                                             start=<span style="color: red">Medium.specificEnthalpy_pTX</span>(
                                                     p=Medium.p_default,
                                                     T=Medium.T_default,
                                                     X=Medium.X_default)) <span style="color: #006400">
    &quot;Leaving temperature of the component&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> XiOut[Medium.nXi](<span style="color: blue">each </span>unit=&quot;1&quot;,
                                                          <span style="color: blue">each </span>min=0,
                                                          <span style="color: blue">each </span>max=1) <span style="color: #006400">
    &quot;Leaving species concentration of the component&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> COut[Medium.nC](<span style="color: blue">each </span>min=0) <span style="color: #006400">
    &quot;Leaving trace substances of the component&quot;</span>;

  <span style="color: blue">constant </span>Boolean use_safeDivision=true <span style="color: #006400">
    &quot;Set to true to improve numerical robustness&quot;</span>;
<span style="color: blue">protected </span>
  Real m_flowInv(unit=&quot;s/kg&quot;) <span style="color: #006400">&quot;Regularization of 1/m_flow&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> mXi_flow[Medium.nXi] <span style="color: #006400">
    &quot;Mass flow rates of independent substances added to the medium&quot;</span>;

  <span style="color: #006400">// Parameters that is used to construct the vector mXi_flow</span>
  <span style="color: blue">final </span><span style="color: blue">parameter </span>Real s[Medium.nXi] = {<span style="color: blue">if </span><span style="color: red">Modelica.Utilities.Strings.isEqual</span>(string1=Medium.substanceNames[i],
                                            string2=&quot;Water&quot;,
                                            caseSensitive=false)<span style="color: blue">
                                            then </span>1<span style="color: blue"> else </span>0 <span style="color: blue">for </span>i<span style="color: blue"> in </span>1:Medium.nXi} <span style="color: #006400">
    &quot;Vector with zero everywhere except where species is&quot;</span>;

<span style="color: blue">initial </span><span style="color: blue">equation </span>
  <span style="color: #006400">// Assert that the substance with name &#39;water&#39; has been found.</span>
  <span style="color: red">assert</span>(Medium.nXi == 0<span style="color: blue"> or </span><span style="color: red">abs</span>(<span style="color: red">sum</span>(s)-1) &lt; 1e-5,
      &quot;If Medium.nXi &gt; 1, then substance &#39;water&#39; must be present for one component.&#39;&quot;
         + Medium.mediumName + &quot;&#39;.\n&quot;
         + &quot;Check medium model.&quot;);

<span style="color: blue">equation </span>
 <span style="color: #006400">// Species flow rate from connector mWat_flow</span>
 mXi_flow = mWat_flow * s;
  <span style="color: #006400">// Regularization of m_flow around the origin to avoid a division by zero</span>
 <span style="color: blue">if </span>use_safeDivision<span style="color: blue"> then</span>
    m_flowInv =<span style="color: red"> Buildings.Utilities.Math.Functions.inverseXRegularized</span>(x=port_a.m_flow, delta=m_flow_small/1E3);
 <span style="color: blue">else</span>
     m_flowInv = 0;<span style="color: #006400"> // m_flowInv is not used if use_safeDivision = false.</span>
 <span style="color: blue">end if</span>;

 <span style="color: blue">if </span>allowFlowReversal<span style="color: blue"> then</span>
   <span style="color: #006400">// Formulate hOut using spliceFunction. This avoids an event iteration.</span>
   <span style="color: #006400">// The introduced error is small because deltax=m_flow_small/1e3</span>
   hOut =<span style="color: red"> Buildings.Utilities.Math.Functions.spliceFunction</span>(pos=port_b.h_outflow,
                                                            neg=port_a.h_outflow,
                                                            x=port_a.m_flow,
                                                            deltax=m_flow_small/1E3);
   XiOut =<span style="color: red"> Buildings.Utilities.Math.Functions.spliceFunction</span>(pos=port_b.Xi_outflow,
                                                            neg=port_a.Xi_outflow,
                                                            x=port_a.m_flow,
                                                            deltax=m_flow_small/1E3);
   COut =<span style="color: red"> Buildings.Utilities.Math.Functions.spliceFunction</span>(pos=port_b.C_outflow,
                                                            neg=port_a.C_outflow,
                                                            x=port_a.m_flow,
                                                            deltax=m_flow_small/1E3);
 <span style="color: blue">else</span>
   hOut =  port_b.h_outflow;
   XiOut = port_b.Xi_outflow;
   COut =  port_b.C_outflow;
 <span style="color: blue">end if</span>;

  <span style="color: #006400">//////////////////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400">// Energy balance and mass balance</span>
  <span style="color: blue">if </span>sensibleOnly<span style="color: blue"> then</span>
    <span style="color: #006400">// Mass balance</span>
    port_a.m_flow = -port_b.m_flow;
    <span style="color: #006400">// Energy balance</span>
    <span style="color: blue">if </span>use_safeDivision<span style="color: blue"> then</span>
      port_b.h_outflow =<span style="color: red"> inStream</span>(port_a.h_outflow) + Q_flow * m_flowInv;
      port_a.h_outflow =<span style="color: red"> inStream</span>(port_b.h_outflow) - Q_flow * m_flowInv;
    <span style="color: blue">else</span>
      port_a.m_flow * (<span style="color: red">inStream</span>(port_a.h_outflow) - port_b.h_outflow) = -Q_flow;
      port_a.m_flow * (<span style="color: red">inStream</span>(port_b.h_outflow) - port_a.h_outflow) = +Q_flow;
    <span style="color: blue">end if</span>;
    <span style="color: #006400">// Transport of species</span>
    port_a.Xi_outflow =<span style="color: red"> inStream</span>(port_b.Xi_outflow);
    port_b.Xi_outflow =<span style="color: red"> inStream</span>(port_a.Xi_outflow);
    <span style="color: #006400">// Transport of trace substances</span>
    port_a.C_outflow =<span style="color: red"> inStream</span>(port_b.C_outflow);
    port_b.C_outflow =<span style="color: red"> inStream</span>(port_a.C_outflow);
  <span style="color: blue">else</span>
    <span style="color: #006400">// Mass balance (no storage)</span>
    port_a.m_flow + port_b.m_flow = -mWat_flow;
    <span style="color: #006400">// Energy balance.</span>
    <span style="color: #006400">// This equation is approximate since m_flow = port_a.m_flow is used for the mass flow rate</span>
    <span style="color: #006400">// at both ports. Since mWat_flow &lt;&lt; m_flow, the error is small.</span>
    <span style="color: blue">if </span>use_safeDivision<span style="color: blue"> then</span>
      port_b.h_outflow =<span style="color: red"> inStream</span>(port_a.h_outflow) + Q_flow * m_flowInv;
      port_a.h_outflow =<span style="color: red"> inStream</span>(port_b.h_outflow) - Q_flow * m_flowInv;
      <span style="color: #006400">// Transport of species</span>
      port_b.Xi_outflow =<span style="color: red"> inStream</span>(port_a.Xi_outflow) + mXi_flow * m_flowInv;
      port_a.Xi_outflow =<span style="color: red"> inStream</span>(port_b.Xi_outflow) - mXi_flow * m_flowInv;
     <span style="color: blue">else</span>
      port_a.m_flow * (<span style="color: red">inStream</span>(port_a.h_outflow) - port_b.h_outflow) = -Q_flow;
      port_a.m_flow * (<span style="color: red">inStream</span>(port_b.h_outflow) - port_a.h_outflow) = +Q_flow;
      <span style="color: #006400">// Transport of species</span>
      port_a.m_flow * (<span style="color: red">inStream</span>(port_a.Xi_outflow) - port_b.Xi_outflow) = -mXi_flow;
      port_a.m_flow * (<span style="color: red">inStream</span>(port_b.Xi_outflow) - port_a.Xi_outflow) = +mXi_flow;
     <span style="color: blue">end if</span>;

    <span style="color: #006400">// Transport of trace substances</span>
   port_a.m_flow*port_a.C_outflow = -port_b.m_flow*<span style="color: red">inStream</span>(port_b.C_outflow);
   port_b.m_flow*port_b.C_outflow = -port_a.m_flow*<span style="color: red">inStream</span>(port_a.C_outflow);

  <span style="color: blue">end if</span>;<span style="color: #006400"> // sensibleOnly</span>

  <span style="color: #006400">//////////////////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400">// No pressure drop in this model</span>
  port_a.p = port_b.p;

<span style="color: blue">end </span>StaticTwoPortConservationEquation;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE StaticTwoPortHeatMassExchanger<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interfacee19327459e14118bangerI.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.StaticTwoPortHeatMassExchanger</h2>
<p>
<b>Partial model transporting fluid between two ports without storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interfacee19327459e14118bangerD.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger">
</p>
<h3>Information</h3>

<p>
This component transports fluid between its two ports, without
storing mass or energy. It is based on 
<a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPortTransport"
>
Modelica.Fluid.Interfaces.PartialTwoPortTransport</a> but it does
use a different implementation for handling reverse flow because
in this component, mass flow rate can be added or removed from
the medium.
</p>
<p>
If <code>dp_nominal &gt; Modelica.Constants.eps</code>, this component computes
pressure drop due to flow friction.
The pressure drop is defined by a quadratic function that goes through
the point <code>(m_flow_nominal, dp_nominal)</code>. At <code>|m_flow| &lt; deltaM * m_flow_nominal</code>,
the pressure drop vs. flow relation is linearized.
If the parameter <code>linearizeFlowResistance</code> is set to true,
then the whole pressure drop vs. flow resistance curve is linearized.
</p>
<h4>Implementation</h4>
This model uses inputs and constants that need to be set by models
that extend or instantiate this model.
The following inputs need to be assigned:
<ul>
<li>
<code>Q_flow</code>, which is the heat flow rate added to the medium.
</li>
<li>
<code>mWat_flow</code>, which is the moisture mass flow rate added to the medium.
</li>
</ul>

<p>
Set the constant <code>sensibleOnly=true</code> if the model that extends
or instantiates this model sets <code>mWat_flow = 0</code>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a> (Partial model transporting fluid between two ports without storing mass or energy), <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters</a> (Parameters for flow resistance for models with two ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Boolean</td><td>sensibleOnly</td><td>&nbsp;</td><td>Set to true if sensible exchange only</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp_nominal</td><td>&nbsp;</td><td>Pressure [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_small</td><td>1E-4*abs(m_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr><td>Boolean</td><td>computeFlowResistance</td><td>(abs(dp_nominal) &gt; Modelica....</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>hOut</td><td>Leaving temperature of the component [J/kg]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>XiOut[Medium.nXi]</td><td>Leaving species concentration of the component [1]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>COut[Medium.nC]</td><td>Leaving trace substances of the component</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">model</span> StaticTwoPortHeatMassExchanger <span style="color: #006400">
  &quot;Partial model transporting fluid between two ports without storing mass or energy&quot;</span>
  <span style="color: blue">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a>(
  showDesignFlowDirection = false);
  <span style="color: blue">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters</a>(
    <span style="color: blue">final </span>computeFlowResistance=(<span style="color: red">abs</span>(dp_nominal) &gt; Modelica.Constants.eps));

  <span style="color: blue">parameter </span>Boolean homotopyInitialization = true <span style="color: #006400">&quot;= true, use homotopy method&quot;</span>;

  <span style="color: #006400">// Model inputs</span>
  <span style="color: blue">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q_flow <span style="color: #006400">&quot;Heat transfered into the medium&quot;</span>;
  <span style="color: blue">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> mWat_flow <span style="color: #006400">
    &quot;Moisture mass flow rate added to the medium&quot;</span>;

  <span style="color: #006400">// Models for conservation equations and pressure drop</span>
  <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation"
>Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation</a> vol(
    sensibleOnly = sensibleOnly,
    use_safeDivision = use_safeDivision,
    <span style="color: blue">redeclare </span><span style="color: blue">final </span><span style="color: blue">package</span> Medium = Medium,
    <span style="color: blue">final </span>m_flow_nominal = m_flow_nominal,
    <span style="color: blue">final </span>allowFlowReversal=allowFlowReversal,
    <span style="color: blue">final </span>m_flow_small=m_flow_small) <span style="color: #006400">
    &quot;Control volume for steady-state energy and mass balance&quot;</span>;
  <a href="Buildings_Fluid_FixedResistances.html#Buildings.Fluid.FixedResistances.FixedResistanceDpM"
>Buildings.Fluid.FixedResistances.FixedResistanceDpM</a> preDro(
    <span style="color: blue">redeclare </span><span style="color: blue">final </span><span style="color: blue">package</span> Medium = Medium,
    <span style="color: blue">final </span>use_dh=false,
    <span style="color: blue">final </span>m_flow_nominal=m_flow_nominal,
    <span style="color: blue">final </span>deltaM=deltaM,
    <span style="color: blue">final </span>allowFlowReversal=allowFlowReversal,
    <span style="color: blue">final </span>show_T=false,
    <span style="color: blue">final </span>from_dp=from_dp,
    <span style="color: blue">final </span>linearized=linearizeFlowResistance,
    <span style="color: blue">final </span>homotopyInitialization=homotopyInitialization,
    <span style="color: blue">final </span>dp_nominal=dp_nominal) <span style="color: #006400">&quot;Pressure drop model&quot;</span>;

  <span style="color: #006400">// Outputs that are needed in models that extend this model</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> hOut(unit=&quot;J/kg&quot;) <span style="color: #006400">
    &quot;Leaving temperature of the component&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> XiOut[Medium.nXi](<span style="color: blue">each </span>unit=&quot;1&quot;,
                                                          <span style="color: blue">each </span>min=0,
                                                          <span style="color: blue">each </span>max=1) <span style="color: #006400">
    &quot;Leaving species concentration of the component&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> COut[Medium.nC](<span style="color: blue">each </span>min=0) <span style="color: #006400">
    &quot;Leaving trace substances of the component&quot;</span>;

  <span style="color: blue">constant </span>Boolean sensibleOnly <span style="color: #006400">&quot;Set to true if sensible exchange only&quot;</span>;
  <span style="color: blue">constant </span>Boolean use_safeDivision=true <span style="color: #006400">
    &quot;Set to true to improve numerical robustness&quot;</span>;
<span style="color: blue">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> heaInp(y=Q_flow) <span style="color: #006400">
    &quot;Block to set heat input into volume&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a>
    masExc(<span style="color: blue">final </span>y=mWat_flow) <span style="color: #006400">&quot;Block to set moisture exchange in volume&quot;</span>;
<span style="color: blue">equation </span>
  <span style="color: red">connect</span>(vol.hOut, hOut);
  <span style="color: red">connect</span>(vol.XiOut, XiOut);
  <span style="color: red">connect</span>(vol.COut, COut);
  <span style="color: red">connect</span>(port_a,preDro. port_a);
  <span style="color: red">connect</span>(preDro.port_b, vol.port_a);

  <span style="color: red">connect</span>(vol.port_b, port_b);

  <span style="color: red">connect</span>(heaInp.y, vol.Q_flow);
  <span style="color: red">connect</span>(masExc.y, vol.mWat_flow);
<span style="color: blue">end </span>StaticTwoPortHeatMassExchanger;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE TwoPortFlowResistanceParameters<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.TwoPortFlowResistanceParameters</h2>
<p>
<b>Parameters for flow resistance for models with two ports</b>
</p>
<h3>Information</h3>

This class contains parameters that are used to
compute the pressure drop in models that have one fluid stream.
Note that the nominal mass flow rate is not declared here because
the model 
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>
PartialTwoPortInterface</a>
already declares it.

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp_nominal</td><td>&nbsp;</td><td>Pressure [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr><td>Boolean</td><td>computeFlowResistance</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">record</span> TwoPortFlowResistanceParameters <span style="color: #006400">
  &quot;Parameters for flow resistance for models with two ports&quot;</span>

  <span style="color: blue">parameter </span>Boolean computeFlowResistance = true <span style="color: #006400">
    &quot;=true, compute flow resistance. Set to false to assume no friction&quot;</span>;

  <span style="color: blue">parameter </span>Boolean from_dp = false <span style="color: #006400">
    &quot;= true, use m_flow = f(dp) else dp = f(m_flow)&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp_nominal(min=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400">
    &quot;Pressure&quot;</span>;
  <span style="color: blue">parameter </span>Boolean linearizeFlowResistance = false <span style="color: #006400">
    &quot;= true, use linear relation between m_flow and dp for any flow rate&quot;</span>;
  <span style="color: blue">parameter </span>Real deltaM = 0.1 <span style="color: #006400">
    &quot;Fraction of nominal flow rate where flow transitions to laminar&quot;</span>;

<span style="color: blue">end </span>TwoPortFlowResistanceParameters;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE TwoPortHeatMassExchanger<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interfaceaa717523098d688cangerI.png" alt="Buildings.Fluid.Interfaces.TwoPortHeatMassExchanger" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.TwoPortHeatMassExchanger"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.TwoPortHeatMassExchanger</h2>
<p>
<b>Partial model transporting one fluid stream with storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interfaceaa717523098d688cangerD.png" alt="Buildings.Fluid.Interfaces.TwoPortHeatMassExchanger">
</p>
<h3>Information</h3>

<p>
This component transports one fluid stream. 
It provides the basic model for implementing dynamic and steady-state
models that exchange heat and water vapor with the fluid stream.
The model also computes the pressure drop due to the flow resistance.
By setting the parameter <code>dp_nominal=0</code>, the computation
of the pressure drop can be avoided.
The variable <code>vol.heatPort.T</code> always has the value of
the temperature of the medium that leaves the component.
For the actual temperatures at the port, the variables <code>sta_a.T</code>
and <code>sta_b.T</code> can be used. These two variables are provided by 
the base class
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>
Buildings.Fluid.Interfaces.PartialTwoPortInterface</a>.
</p>

For models that extend this model, see for example
<ul>
<li>
the ideal heater or cooler
<a href="Buildings_Fluid_HeatExchangers.html#Buildings.Fluid.HeatExchangers.HeaterCoolerPrescribed"
>
Buildings.Fluid.HeatExchangers.HeaterCoolerPrescribed</a>,
</li>
<li>
the ideal humidifier
<a href="Buildings_Fluid_MassExchangers.html#Buildings.Fluid.MassExchangers.HumidifierPrescribed"
>
Buildings.Fluid.MassExchangers.HumidifierPrescribed</a>, and
</li>
<li>
the boiler
<a href="Buildings_Fluid_Boilers.html#Buildings.Fluid.Boilers.BoilerPolynomial"
>
Buildings.Fluid.Boilers.BoilerPolynomial</a>.
</li>
</ul>

<h4>Implementation</h4>
<p>
The variable names follow the conventions used in 
<a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Examples_HeatExchanger_BaseClasses.html#Modelica.Fluid.Examples.HeatExchanger.BaseClasses.BasicHX"
>
Modelica.Fluid.Examples.HeatExchanger.BaseClasses.BasicHX
</a>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a> (Partial model transporting fluid between two ports without storing mass or energy), <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters</a> (Parameters for flow resistance for models with two ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td><a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>MixingVolume</a></td><td>vol</td><td>redeclare Buildings.Fluid.Mi...</td><td>Volume for fluid stream</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp_nominal</td><td>&nbsp;</td><td>Pressure [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>system.allowFlowReversal</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_small</td><td>1E-4*abs(m_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr><td>Boolean</td><td>computeFlowResistance</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau</td><td>30</td><td>Time constant at nominal flow (if energyDynamics &lt;&gt; SteadyState) [s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">model</span> TwoPortHeatMassExchanger <span style="color: #006400">
  &quot;Partial model transporting one fluid stream with storing mass or energy&quot;</span>
  <span style="color: blue">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a>(
    port_a(h_outflow(start=h_outflow_start)),
    port_b(h_outflow(start=h_outflow_start)));
  <span style="color: blue">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters</a>(
    <span style="color: blue">final </span>computeFlowResistance=true);

  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> tau = 30 <span style="color: #006400">
    &quot;Time constant at nominal flow (if energyDynamics &lt;&gt; SteadyState)&quot;</span>;

  <span style="color: #006400">// Advanced</span>
  <span style="color: blue">parameter </span>Boolean homotopyInitialization = true <span style="color: #006400">&quot;= true, use homotopy method&quot;</span>;

  <span style="color: #006400">// Dynamics</span>
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> energyDynamics=Modelica.Fluid.Types.Dynamics.DynamicFreeInitial <span style="color: #006400">
    &quot;Formulation of energy balance&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> massDynamics=energyDynamics <span style="color: #006400">
    &quot;Formulation of mass balance&quot;</span>;

  <span style="color: #006400">// Initialization</span>
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>Medium.AbsolutePressure</a> p_start = Medium.p_default <span style="color: #006400">
    &quot;Start value of pressure&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Medium.Temperature</a> T_start = Medium.T_default <span style="color: #006400">
    &quot;Start value of temperature&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>Medium.MassFraction</a> X_start[Medium.nX] = Medium.X_default <span style="color: #006400">
    &quot;Start value of mass fractions m_i/m&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium.ExtraProperty</a> C_start[Medium.nC](
       quantity=Medium.extraPropertiesNames)=<span style="color: red">fill</span>(0, Medium.nC) <span style="color: #006400">
    &quot;Start value of trace substances&quot;</span>;

  <span style="color: blue">replaceable </span><a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>Buildings.Fluid.MixingVolumes.MixingVolume</a> vol
  <span style="color: blue">constrainedby </span>Buildings.Fluid.MixingVolumes.BaseClasses.PartialMixingVolume(
    <span style="color: blue">redeclare </span><span style="color: blue">final </span><span style="color: blue">package</span> Medium = Medium,
    nPorts = 2,
    V=m_flow_nominal*tau/rho_default,
    <span style="color: blue">final </span>m_flow_nominal = m_flow_nominal,
    <span style="color: blue">final </span>energyDynamics=energyDynamics,
    <span style="color: blue">final </span>massDynamics=massDynamics,
    <span style="color: blue">final </span>p_start=p_start,
    <span style="color: blue">final </span>T_start=T_start,
    <span style="color: blue">final </span>X_start=X_start,
    <span style="color: blue">final </span>C_start=C_start) <span style="color: #006400">&quot;Volume for fluid stream&quot;</span>;

  <a href="Buildings_Fluid_FixedResistances.html#Buildings.Fluid.FixedResistances.FixedResistanceDpM"
>Buildings.Fluid.FixedResistances.FixedResistanceDpM</a> preDro(
    <span style="color: blue">redeclare </span><span style="color: blue">package</span> Medium = Medium,
    <span style="color: blue">final </span>use_dh=false,
    <span style="color: blue">final </span>m_flow_nominal=m_flow_nominal,
    <span style="color: blue">final </span>deltaM=deltaM,
    <span style="color: blue">final </span>allowFlowReversal=allowFlowReversal,
    <span style="color: blue">final </span>show_T=false,
    <span style="color: blue">final </span>from_dp=from_dp,
    <span style="color: blue">final </span>linearized=linearizeFlowResistance,
    <span style="color: blue">final </span>homotopyInitialization=homotopyInitialization,
    <span style="color: blue">final </span>dp_nominal=dp_nominal) <span style="color: #006400">&quot;Pressure drop model&quot;</span>;

<span style="color: blue">protected </span>
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> sta_default=<span style="color: red">Medium.setState_pTX</span>(
      T=Medium.T_default, p=Medium.p_default, X=Medium.X_default);
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho_default=<span style="color: red">Medium.density</span>(sta_default) <span style="color: #006400">
    &quot;Density, used to compute fluid volume&quot;</span>;
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> sta_start=<span style="color: red">Medium.setState_pTX</span>(
      T=T_start, p=p_start, X=X_start);
  <span style="color: blue">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h_outflow_start =<span style="color: red"> Medium.specificEnthalpy</span>(sta_start) <span style="color: #006400">
    &quot;Start value for outflowing enthalpy&quot;</span>;

<span style="color: blue">initial </span><span style="color: blue">algorithm </span>
  <span style="color: red">assert</span>((energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue"> or </span>
          tau &gt; Modelica.Constants.eps,
&quot;The parameter tau, or the volume of the model from which tau may be derived, is unreasonably small.
 You need to set energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau = &quot; +<span style="color: red"> String</span>(tau) + &quot;\n&quot;);
  <span style="color: red">assert</span>((massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue"> or </span>
          tau &gt; Modelica.Constants.eps,
&quot;The parameter tau, or the volume of the model from which tau may be derived, is unreasonably small.          
 You need to set massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau = &quot; +<span style="color: red"> String</span>(tau) + &quot;\n&quot;);

<span style="color: blue">equation </span>
  <span style="color: red">connect</span>(vol.ports[2], port_b);
  <span style="color: red">connect</span>(port_a, preDro.port_a);
  <span style="color: red">connect</span>(preDro.port_b, vol.ports[1]);
<span style="color: blue">end </span>TwoPortHeatMassExchanger;
</div>
<hr>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Thu Jun 19 10:57:12 2014.
</address>
</body>
</html>
